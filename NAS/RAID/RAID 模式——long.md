## RAID 模式：Single / JBOD / RAID 0 / RAID 1 / RAID 5 / RAID 6 / RAID 10
这些模式本质上回答 3 个问题：
1. **容量怎么拼**（可用容量）
2. **数据怎么分布**（条带/镜像/校验）
3. **坏盘时怎么保证可用/可恢复**（容错与重建）

---

### 通用概念（先理解这 3 个词）

- **条带（Striping）**：把数据切成块（chunk/stripe unit），分散写到多块盘上 → 主要为了提速/提吞吐。
- **镜像（Mirroring）**：同一份数据写两份到不同盘 → 主要为了可靠性。
- **校验（Parity）**：额外存“校验信息”（常见 XOR/RS 等），坏盘后可用剩余数据块+校验块“算回”丢失数据 → 兼顾容量与容错。

---

## 一张表快速对比（假设每块盘容量相同，均为 S）

| 模式                     | 数据怎么放                        |   最少盘数 |         可用容量 |     容错（允许同时坏几块） | 性能特点（典型）   | 典型场景        |
| ---------------------- | ---------------------------- | -----: | -----------: | --------------: | ---------- | ----------- |
| **Single（单盘）**         | 每块盘各自独立成卷                    |      1 |       1×S/每盘 |               0 | 取决于单盘      | 临时数据、分盘存储   |
| **JBOD / SPAN（拼盘/线性）** | 盘独立（JBOD）或按顺序“接起来”（SPAN/BIG） |     1+ | 累加：N×S（可混大小） |   0（做成单一大卷时更脆弱） | 不提速（通常）    | 追求容量、归档/冷数据 |
| **RAID 0**             | 纯条带                          |      2 |          N×S |               0 | 读写吞吐高      | 缓存/临时/可丢数据  |
| **RAID 1**             | 纯镜像                          |      2 |      1×S（两盘） |         1（两盘镜像） | 读可并行；写≈单盘  | 关键数据、小盘位    |
| **RAID 5**             | 条带 + 分布式单校验                  |      3 |      (N−1)×S |               1 | 读好；小随机写开销大 | 文件共享、通用业务   |
| **RAID 6**             | 条带 + 分布式双校验                  |      4 |      (N−2)×S |               2 | 读尚可；写更慢    | 大盘/多盘位、要求更稳 |
| **RAID 10（1+0）**       | 镜像成对 + 对各对做条带                | 4（且偶数） |      (N/2)×S | 取决于坏盘分布：每对最多坏 1 | 读写都强，随机写强  | 数据库/虚拟化/高IO |

---

## 各模式怎么工作 + 特色

### 1) Single（单盘模式）

**怎么工作**：每块磁盘单独建“存储池/卷”，互不关联（就像普通电脑多块硬盘）。

**特色**：
- 最简单、最直观
- **没有任何冗余**，坏了就坏了

**适合**：
- 希望“某盘放某类数据”
- 需要后续单独迁移/更换盘位

---

### 2) JBOD / SPAN（线性拼接）

这里常被混用，建议你在 NAS UI 里看清楚到底是哪一种：

- **JBOD（严格意义）**：多块盘各自独立暴露给系统；也可以由上层卷管理器再去组合。
- **SPAN/BIG（很多 NAS UI 里也叫 JBOD）**：把多块盘按顺序拼成一个大逻辑卷（写满第一块再写第二块）。

**特色/风险**：
- 不做镜像、不做校验，**不提供容错**
- 如果是“拼成一个大卷”的 SPAN：任意一块盘坏，这个大卷就可能整体不可用（至少会丢一部分且难管理）

**优点**：
- 容量利用率高（能混盘、容量能累加）
- 扩容方便、逻辑简单

---

### 3) RAID 0（纯条带）

**怎么工作**：文件被切块，交错写到每块盘上（Disk1 写 A1，Disk2 写 A2，Disk3 写 A3…）。

**特色**：
- **优点**：吞吐和并发 I/O 提升明显（盘越多越快，受控制器/队列深度/负载类型影响）
- **致命缺点**：**0 冗余**。坏一块盘，条带被破坏，阵列通常整体不可用。

**条带大小（stripe size）**：
- 大顺序读写（视频/大文件）：偏大 stripe 更友好
- 小随机 I/O：过大或过小都可能不理想（取决于应用 I/O 尺寸），一般按系统默认或厂商建议

---

### 4) RAID 1（镜像）

**怎么工作**：写入时两块盘同步写同样的数据；读取时可从任意一块读（可做读均衡）。

**特色**：
- **优点**：容错简单直接，坏一块盘仍可用；重建就是“把好盘完整复制到新盘”
- **缺点**：容量利用率低（两盘只有 50% 可用）

**适合**：关键数据、两盘位设备、小型 NAS 的稳妥方案。

---

### 5) RAID 5（条带 + 分布式单校验）

**怎么工作**：数据条带化，同时每条带会有 1 份校验块，且校验块分散在不同磁盘上（避免单独校验盘瓶颈）。坏 1 块盘时，可用剩余数据块 + 校验块重建丢失块。

**特色**：
- **优点**：容量利用率比 RAID 1 高，能容忍坏 1 块；读取通常不错
- **缺点（重点）**：小随机写常有“写惩罚”（一次逻辑写可能触发额外读旧数据/旧校验，再写新数据/新校验）

**适合**：三盘及以上、以读为主/读写均衡、接受坏 1 盘的场景（共享文件、一般业务存储）。

---

### 6) RAID 6（条带 + 分布式双校验）

**怎么工作**：在 RAID 5 基础上，每条带存两份独立校验信息，因此可同时容忍 **2 块盘故障**。

**特色**：
- **优点**：比 RAID 5 更稳（盘位多、单盘容量大、重建时间长时更保险）
- **缺点**：写入开销更大（维护双校验），可用容量也更少（要“让出 2 块盘容量”）

**适合**：4 盘及以上、对可用性要求更高的 NAS/存储（照片库、重要文件、备份仓但要求在线可用等）。

---

### 7) RAID 10（1+0：镜像条带）

**怎么工作**：先把磁盘两两做镜像（RAID 1），再在“镜像对”之间做条带（RAID 0）。至少 4 块盘且通常要求偶数盘。

**特色**：
- **优点**：读写性能都强（尤其随机写），同时有镜像冗余；重建通常也比 RAID 5/6 更“直接”（复制镜像对）
- **容错细节**：可以坏多块，但**不能在同一对镜像里两块都坏**（那一对数据就没了）
- **缺点**：容量利用率 50%，成本高

**适合**：数据库、虚拟化、频繁写入、小随机 I/O 多的业务（“要快也要稳”）。

---

## 选型建议（按“你最在意什么”）

- **最在意容量**：JBOD/SPAN（但要接受 0 冗余），或 RAID 5/6
- **最在意安全（且盘位少）**：RAID 1
- **盘位多/单盘大、想更稳**：RAID 6
- **最在意综合性能 + 可用性（尤其写多）**：RAID 10
- **只要速度、数据可丢**：RAID 0

> 关键提醒：RAID 提供的是“可用性/容错”，不是备份；误删、勒索、应用写坏、静默损坏等，仍需要快照/异地备份策略（NAS 场景尤其重要）。

